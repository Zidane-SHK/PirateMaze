"""
Purpose: Defines the ship's graph structure for A* pathfinding algorithm
Scenario: Help Lethal Luke collect 4 cannonballs and load all cannons to reach the finish
"""

# ===== SCREEN SETTINGS =====
SCREEN_WIDTH = 1000
SCREEN_HEIGHT = 1200
FPS = 60

# --- COLORS (Used by Visualizer) ---
WHITE = (255, 255, 255)
BLACK = (0, 0, 0)
RED = (255, 0, 0)
GREEN = (0, 255, 0)
BLUE = (0, 0, 255)
YELLOW = (255, 255, 0)

# ===== GAME LOGIC =====
START_NODE = '50'  # Green Node (Top Deck)
FINISH_NODE = '49' # Black Node (Top Deck)

# The specific sequence Luke must travel to solve the puzzle
# This ensures he doesn't just walk straight to the finish
MISSION_CHECKPOINTS = [
    '37',  # Cannonball 1 (Deck 4 Left)
    '1',   # Cannonball 2 (Bottom Deck)
    '28',  # Cannonball 3 (Deck 5 Right)
    '4',   # Cannonball 4 (Deck 1 Center) - Or adjust to specific logic
    FINISH_NODE
]

# ===== NODE COORDINATES =====
COORDS = {
    # Deck 0 (Bottom Deck)
    '1': (448, 1104),

    # Deck 1
    '2': (327, 1020), '3': (552, 1013), '4': (606, 988), '5': (702, 1012),

    # Deck 2
    '6': (488, 927), '7': (679, 922), '8': (796, 921), '9': (845, 917),
    '10': (362, 924), '11': (319, 911), '12': (225, 921),

    # Deck 3
    '13': (153, 839), '14': (285, 842), '15': (437, 842), '16': (577, 838),
    '17': (652, 826), '18': (743, 836), '19': (839, 833), '20': (920, 790),
    '21': (327, 809),

    # Deck 4
    '22': (188, 745), '23': (324, 729), '24': (456, 731), '25': (604, 731),
    '26': (670, 740), '27': (775, 726), '37': (108, 699),

    # Deck 5
    '28': (793, 632), '29': (877, 581), '30': (719, 618), '31': (628, 627),
    '32': (596, 626), '33': (416, 627), '34': (451, 600), '35': (351, 633),
    '36': (212, 630),

    # Deck 6
    '38': (234, 539), '39': (416, 536), '40': (529, 533), '41': (579, 531),
    '42': (683, 538), '43': (745, 525),

    # Deck 7
    '44': (778, 442), '45': (571, 445), '46': (478, 425), '47': (383, 445),
    '48': (249, 425),

    # Deck 8 (Top Deck)
    '49': (348, 343), '50': (665, 340),
}

# ===== ADJACENCY LIST (The Graph) =====
# Defines valid paths. Replaced all '_' with valid integers.
GRAPH = {
    # Deck 0
    '1': [('2', 1), ('3', 1)],
    
    # Deck 1
    '2': [('1', 1), ('3', 2), ('10', 1)],
    '3': [('1', 1), ('2', 2), ('4', 1)],
    '4': [('3', 1), ('5', 3), ('7', 1), ('6', 3)],
    '5': [('4', 3), ('8', 1)],
    
    # Deck 2
    '6': [('4', 3), ('16', 3), ('10', 2)],
    '7': [('4', 1), ('18', 3)],
    '8': [('5', 1), ('9', 1), ('18', 3)],
    '9': [('19', 3), ('8', 1)],
    '10': [('6', 2), ('11', 1), ('2', 1)],
    '11': [('10', 1)],
    '12': [('13', 1), ('14', 1)],
    
    # Deck 3
    '13': [('12', 1), ('22', 1)],
    '14': [('12', 1), ('21', 1)],
    '15': [('21', 2), ('16', 2)],
    '16': [('6', 3), ('15', 2), ('17', 3)],
    '17': [('18', 1), ('16', 3)],
    '18': [('8', 3), ('17', 1), ('19', 2), ('7', 3)],
    '19': [('9', 3), ('18', 2), ('20', 3)],
    '20': [('19', 3), ('27', 1)],
    '21': [('14', 1), ('15', 2), ('24', 3), ('23', 1), ('22', 3)],
    
    # Deck 4
    '22': [('13', 1), ('21', 3), ('23', 2), ('37', 1)],
    '23': [('35', 2), ('22', 2), ('21', 1)],
    '24': [('21', 3), ('25', 3)],
    '25': [('26', 1), ('24', 3)],
    '26': [('27', 2), ('25', 1)],
    '27': [('28', 2), ('26', 2), ('20', 1)],
    '37': [('22', 1), ('36', 1)],
  
    # Deck 5
    '28': [('29', 1), ('27', 2), ('30', 1)], # Fixed '_'
    '29': [('28', 1), ('43', 1)],            # Fixed empty
    '30': [('28', 1), ('31', 1)],
    '31': [('32', 1), ('30', 1), ('42', 3)], # Fixed '_'
    '32': [('34', 1), ('31', 1)],            # Fixed '_'
    '33': [('35', 1), ('34', 2)],
    '34': [('39', 3), ('33', 2), ('32', 1), ('41', 2), ('40', 1)],
    '35': [('36', 2), ('33', 1), ('23', 2)],
    '36': [('37', 1), ('35', 2), ('38', 2)],
    
    # Deck 6
    '38': [('36', 2), ('39', 2)],
    '39': [('34', 3), ('38', 2)],
    '40': [('34', 1), ('41', 1)],            # Fixed '_'
    '41': [('42', 2), ('34', 2), ('40', 1)], # Fixed '_'
    '42': [('43', 2), ('41', 2), ('31', 3)],
    '43': [('42', 2), ('29', 1)],
    
    # Deck 7
    '44': [('50', 1), ('45', 1)],
    '45': [('46', 1), ('44', 1)],
    '46': [('49', 2), ('50', 3), ('45', 1), ('47', 1)],
    '47': [('46', 1), ('48', 1)],
    '48': [('49', 3), ('47', 1)],
    
    # Deck 8 (Top)
    '49': [('46', 2), ('48', 3)],  # FINISH node
    '50': [('44', 1), ('46', 3)],  # START node
}

# Nodes that contain cannonballs (Used for visual debugging)
CANNONBALL_NODES = ['4', '21', '34', '46']

# Helper Dictionary for Deck Levels (Used for debug printing)
DECK_LEVELS = {
    0: ['1'],
    1: ['2', '3', '4', '5'],
    2: ['6', '7', '8', '9', '10', '11', '12'],
    3: ['13', '14', '15', '16', '17', '18', '19', '20', '21'],
    4: ['22', '23', '24', '25', '26', '27', '37'],
    5: ['28', '29', '30', '31', '32', '33', '34', '35', '36'],
    6: ['38', '39', '40', '41', '42', '43'],
    7: ['44', '45', '46', '47', '48'],
    8: ['49', '50']
}

# --- Helper Functions ---
NODE_TO_DECK = {}
for deck, nodes in DECK_LEVELS.items():
    for node in nodes:
        NODE_TO_DECK[node] = deck

def get_deck_level(node):
    return NODE_TO_DECK.get(node, -1)

def get_nodes_on_deck(deck_num):
    return DECK_LEVELS.get(deck_num, [])

def validate_graph():
    print("Validating Graph...")
    errors = []
    for node in GRAPH:
        if node not in COORDS: errors.append(f"Node {node} missing from COORDS")
    if not errors: print("Graph Validated Successfully.")
    else: print(errors)

if __name__ == "__main__":
    validate_graph()